<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>çˆ¬å–ä»Šæ—¥å¤´æ¡ | Welcome to Fu Ming yao&#39;s personal blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="ç¬¦é“­å°§">
  <meta name="keywords" content>
  <meta name="description" content>
  <script id="hexo-configurations">
  var CONFIG = {
    root: '/',
    theme: 'hexo-theme-lx',
    version: '1.4.5',
    localsearch:{
      "enable": false,
      "trigger": "auto",
      "top_n_per_article": 1,
      "unescape": false,
      "preload": false
      },
    path: '-'
  };
</script>

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/main.css">
  <script src="/js/jquery.min.js"></script>
  <script src="/js/jquery.jside.menu.js"></script>
	<script>
	$(document).ready(function(){
	$(".menu-container").jSideMenu({
	    jSidePosition: "position-right",
	    jSideSticky: true,
	    jSideSkin: "endless-river",
	     });
	}); 
	</script>
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300|Noto+Serif+SC&amp;display=swap">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4/css/font-awesome.min.css">
</head>
<body>
<div class="single">
<div id="page">
<div id="lx-aside" style="background-image: url(/images/page-cover.jpg)" data-stellar-background-ratio="0.5">
  <div class="overlay">
  <div class="page-title">
    <div class="avatar"><a href="/"><img src="/images/person_1.jpg"></a></div>
    <span>2019-12-24</span>
    <h2>çˆ¬å–ä»Šæ—¥å¤´æ¡</h2>
    
    </div>
</div>
</div>
<div id="lx-main-content">
  <div class="lx-post">
    <div class="lx-entry padding">
      <div>
        <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»»ä½•çˆ¬è™«å·¥ç¨‹å¸ˆåœ¨çˆ¬å–ç½‘ç«™æ•°æ®ä¹‹å‰éƒ½ä¼šå¯¹ç½‘ç«™è¿›è¡Œåˆ†æï¼Œå¹¶ä¸”è¿›è¡Œ==é€†å‘(js)ç ´è§£(åŠ å¯†)==ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨çˆ¬å–ä»Šæ—¥å¤´æ¡çš„æ–‡ç« å’Œè§†é¢‘æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å…ˆåˆ†æä¸€ä¸‹ä»Šæ—¥å¤´æ¡çš„åçˆ¬è™«æœºåˆ¶ä»¥åŠè¿›è¡Œ==é€†å‘(js)ç ´è§£(åŠ å¯†)==ã€‚</p>
<h1 id="åˆ†æä»Šæ—¥å¤´æ¡"><a href="#åˆ†æä»Šæ—¥å¤´æ¡" class="headerlink" title="åˆ†æä»Šæ—¥å¤´æ¡"></a>åˆ†æä»Šæ—¥å¤´æ¡</h1><p>ä»Šæ—¥å¤´æ¡æŸç”¨æˆ·çš„é“¾æ¥ï¼š==<a href="https://www.toutiao.com/c/user/3410443345/#mid=3413306633==" target="_blank" rel="noopener">https://www.toutiao.com/c/user/3410443345/#mid=3413306633==</a><br><img src="https://img-blog.csdnimg.cn/20191101152616547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="ä»Šæ—¥å¤´æ¡æŸç”¨æˆ·é“¾æ¥"><br>æˆ‘ä»¬å°†å¯¹ä»Šæ—¥å¤´æ¡é“¾æ¥è¿›è¡Œè¯¦ç»†çš„åˆ†æï¼Œä»¥ä¸‹ä¸º==åˆ†ææ­¥éª¤ï¼š==</p>
<h3 id="1-åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦æ˜¯é™æ€æ•°æ®"><a href="#1-åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦æ˜¯é™æ€æ•°æ®" class="headerlink" title="1.åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦æ˜¯é™æ€æ•°æ®"></a>1.åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦æ˜¯é™æ€æ•°æ®</h3><p>æŒ‰==F12==å¼¹å‡ºå¼€å‘è€…ç•Œé¢ï¼Œé€‰æ‹©==NetworkåŒºåŸŸ==ï¼Œä½ ä¼šå‘ç°æœ‰å¾ˆå¤šçš„è¯·æ±‚é“¾æ¥ï¼Œé¼ æ ‡åˆ’åˆ°æœ€ä¸Šé¢ï¼Œç„¶åçœ‹åˆ°æœ‰ä¸€ä¸ªè·Ÿ==ç½‘ç«™URL==ä¸€æ ·çš„é“¾æ¥ï¼Œç‚¹å‡»è¿›å»ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101153216191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æ¼”ç¤ºå›¾"><br><img src="https://img-blog.csdnimg.cn/20191101153510110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æ¼”ç¤ºå›¾"><br>ä»è¿™é‡Œå¾—å‡ºä»Šæ—¥å¤´æ¡ç½‘ç«™çš„æ•°æ®å¹¶ä¸æ˜¯é™æ€æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸‹ä¸€æ­¥åˆ†æã€‚</p>
<h3 id="2-åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦ä¸ºAJAXè¯·æ±‚çš„"><a href="#2-åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦ä¸ºAJAXè¯·æ±‚çš„" class="headerlink" title="2.åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦ä¸ºAJAXè¯·æ±‚çš„"></a>2.åˆ†æç½‘ç«™ä¿¡æ¯æ˜¯å¦ä¸ºAJAXè¯·æ±‚çš„</h3><p>AJAXè¯·æ±‚æ˜¯ç½‘ç«™é€šè¿‡jsè„šæœ¬å‘èµ·çš„è¯·æ±‚è¿æ¥ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†åœ¨ä¸åˆ·æ–°ç½‘é¡µçš„æƒ…å†µä¸‹å°±èƒ½å®æ—¶çš„æ›´æ–°ç½‘é¡µå†…å®¹ï¼Œä»è€Œåœ¨æ„Ÿè§‰ä¸Šä½ æ˜¯è§‰å¾—ä»–å’Œç½‘é¡µæºç æ‹¼æ¥åœ¨ä¸€èµ·ã€‚</p>
<p>æˆ‘ä»¬å†ä»ä¼—å¤šçš„é“¾æ¥ä¸­è¿›è¡Œç­›é€‰ï¼Œç”±äºAJAXçš„ç±»å‹æ˜¯XHRçš„ï¼Œæ‰€ä»¥åœ¨å¼€å‘è€…æ¨¡å¼é‡Œé¢æˆ‘ä»¬é€‰æ‹©XHRï¼Œå°±èƒ½çœ‹åˆ°åªå‰©ä¸‹å‡ ä¸ªé“¾æ¥äº†ï¼Œç„¶åä»è¿™å‡ ä¸ªé“¾æ¥é‡Œé¢æ‰¾å‡ºä¸ç½‘ç«™å†…å®¹æå…¶ç›¸ç¬¦çš„é“¾æ¥å°±å¯ä»¥äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101154655910.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æ¼”ç¤ºå›¾"><br>è¿™æ ·åˆ†æå‡ºæ¥äº†ç½‘ç«™çš„å†…å®¹ä¸»è¦é AJAXè¯·æ±‚çš„æ•°æ®æ¥æ˜¾ç¤ºçš„ã€‚</p>
<h3 id="3-åˆ†æè¯·æ±‚é“¾æ¥"><a href="#3-åˆ†æè¯·æ±‚é“¾æ¥" class="headerlink" title="3.åˆ†æè¯·æ±‚é“¾æ¥"></a>3.åˆ†æè¯·æ±‚é“¾æ¥</h3><p>æˆ‘ä»¬çŸ¥é“è¿™ä¸ªé“¾æ¥åå°±ä¼šè¦å»è¯·æ±‚è¿™ä¸ªé“¾æ¥ï¼Œä»è€Œåœ¨é‡Œé¢è·å–åˆ°è‡ªå·±æƒ³è¦çš„æ•°æ®ï¼Œè¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†æ•°æ®ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹==å¼€å‘è€…å·¥å…·==ä¸­çš„==NetworkåŒºåŸŸ==çš„==HeadersåŒºåŸŸ==ï¼Œç»è¿‡ä¸¤æ¬¡åˆ·æ–°ç½‘é¡µä¼šå‘ç°ä¸¤æ¬¡è¯·æ±‚ä¸­çš„å‚æ•°æ˜¯æœ‰å˜åŒ–çš„ï¼Œä»¥åŠRequest Headersçš„å‚æ•°ä¹Ÿæ˜¯æœ‰å˜åŒ–çš„ï¼Œçœ‹å›¾ã€‚<br>ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼š<br><img src="https://img-blog.csdnimg.cn/20191101160014877.png" alt="ç¬¬ä¸€æ¬¡è¯·æ±‚"><br><img src="https://img-blog.csdnimg.cn/20191101160035641.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="ç¬¬ä¸€æ¬¡è¯·æ±‚"><br>ç¬¬äºŒæ¬¡è¯·æ±‚ï¼š<br><img src="https://img-blog.csdnimg.cn/20191101160056345.png" alt="ç¬¬äºŒæ¬¡è¯·æ±‚"><br><img src="https://img-blog.csdnimg.cn/20191101160109613.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="ç¬¬äºŒæ¬¡è¯·æ±‚"><br>èµ–åŠ è½½è¯·æ±‚ï¼š</p>
<p>è§£é‡Š(ç™¾åº¦ç™¾ç§‘)ï¼šåœ¨Webåº”ç”¨ç¨‹åºä¸­ï¼Œç³»ç»Ÿçš„ç“¶é¢ˆå¸¸åœ¨äºç³»ç»Ÿçš„å“åº”é€Ÿåº¦ã€‚å¦‚æœç³»ç»Ÿå“åº”é€Ÿåº¦è¿‡æ…¢ï¼Œç”¨æˆ·å°±ä¼šå‡ºç°åŸ‹æ€¨æƒ…ç»ªï¼Œç³»ç»Ÿçš„ä»·å€¼ä¹Ÿå› æ­¤ä¼šå¤§æ‰“æŠ˜æ‰£ã€‚å› æ­¤ï¼Œæé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦ï¼Œæ˜¯éå¸¸é‡è¦çš„ã€‚<br>Webåº”ç”¨ç¨‹åºåšçš„æœ€å¤šå°±æ˜¯å’Œåå°æ•°æ®åº“äº¤äº’ï¼Œè€ŒæŸ¥è¯¢æ•°æ®åº“æ˜¯ç§éå¸¸è€—æ—¶çš„è¿‡ç¨‹ã€‚å½“æ•°æ®åº“é‡Œè®°å½•è¿‡å¤šæ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–æ›´æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œæœ‰äººæå‡ºäº†ç¼“å­˜çš„æ¦‚å¿µã€‚ç¼“å­˜å°±æ˜¯å°†ç”¨æˆ·é¢‘ç¹ä½¿ç”¨çš„æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ä»¥ä¾¿å¿«é€Ÿè®¿é—®ã€‚åœ¨ç”¨æˆ·æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢æ“ä½œåï¼ŒæŸ¥è¯¢çš„è®°å½•ä¼šæ”¾åœ¨ç¼“å­˜ä¸­ã€‚å½“ç”¨æˆ·å†æ¬¡æŸ¥è¯¢æ—¶ï¼Œç³»ç»Ÿä¼šé¦–å…ˆä»ç¼“å­˜ä¸­è¯»å–ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œå†æŸ¥è¯¢æ•°æ®åº“ã€‚ç¼“å­˜æŠ€æœ¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šæå‡äº†ç³»ç»Ÿæ€§èƒ½ï¼Œä½†æ˜¯å½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œç¼“å­˜å°±ä¸å¤ªåˆé€‚äº†ã€‚å› ä¸ºå†…å­˜å®¹é‡æœ‰é™ï¼ŒæŠŠè¿‡å¤šçš„æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œä¼šå½±å“ç”µè„‘æ€§èƒ½ã€‚è€Œå¦ä¸€ç§æŠ€æœ¯ï¼Œæ‡’åŠ è½½å¯ä»¥è§£å†³è¿™ç§é—®é¢˜ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101163941394.png" alt="èµ–åŠ è½½è¯·æ±‚"><br><img src="https://img-blog.csdnimg.cn/20191101164001232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="èµ–åŠ è½½è¯·æ±‚"><br>ä»ä¸Šé¢å›¾ç‰‡æ¥çœ‹ï¼Œæˆ‘ä»¬å°±èƒ½å‘ç°é“¾æ¥çš„å‚æ•°å’Œè¯·æ±‚çš„headersçš„å‚æ•°æ˜¯æœ‰å˜åŒ–çš„ã€‚<br>å˜åŒ–å‚æ•°çš„ä½œç”¨ï¼š</p>
<ul>
<li>page_typeï¼šä½œç”¨ï¼šè·å–æ•°æ®çš„ç±»å‹ä¸ºæ–‡ç« è¿˜æ˜¯è§†é¢‘ï¼Œ==è§†é¢‘ä¸º0==ï¼Œ==æ–‡ç« ä¸º1== åŠ å¯†ï¼šå¦</li>
<li>user_idï¼šä½œç”¨ï¼šè·å–é‚£ä¸ªç”¨æˆ·çš„æ•°æ®ï¼Œåœ¨ç”¨æˆ·é“¾æ¥ä¸­è·å–user_idï¼š<a href="https://www.toutiao.com/c/user/==3410443345==/#mid=3413306633" target="_blank" rel="noopener">https://www.toutiao.com/c/user/==3410443345==/#mid=3413306633</a> åŠ å¯†ï¼šå¦</li>
<li>max_behot_time: ä½œç”¨ï¼šè¿ç»­è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œç”¨äºèµ–åŠ è½½ä¸Šï¼Œç¬¬ä¸€æ¬¡å€¼é»˜è®¤ä¸º0ï¼Œåç»­çš„å€¼ä¸ºä¸Šä¸€æ¬¡è¿”å›æ•°æ®ä¸­çš„max_behot_timeçš„å€¼ åŠ å¯†ï¼šå¦</li>
<li>count ä½œç”¨ï¼šå•æ¬¡è¿”å›æœ€å¤§çš„æ•°æ®é‡ï¼Œé»˜è®¤å€¼ä¸º20 åŠ å¯†ï¼šå¦</li>
<li>as ä½œç”¨ï¼šæ¯ä¸€æ¬¡è¯·æ±‚çš„é“¾æ¥æ˜¯å¦æ˜¯æœ€è¿‘çš„æ—¶é—´ åŠ å¯†ï¼šæ˜¯</li>
<li>cp ä½œç”¨ï¼šæ¯ä¸€æ¬¡è¯·æ±‚çš„é“¾æ¥æ˜¯å¦æ˜¯æœ€è¿‘çš„æ—¶é—´ åŠ å¯†ï¼šæ˜¯</li>
<li>_signature ä½œç”¨ï¼šç”¨äºåˆ¤æ–­user_idå’Œmax_behot_timeçš„å€¼è·Ÿé“¾æ¥å’Œheadersçš„å‚æ•°çš„å€¼æ˜¯å¦ç›¸ç­‰ åŠ å¯†ï¼šæ˜¯</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„Request Headersä¸­cookieçš„å‚æ•°(è§£å†³æ–¹æ³•ï¼šæ‰‹åŠ¨è·å–è¿™äº›å‚æ•°çš„å€¼)ï¼š</p>
<ul>
<li>tt_webid ä½œç”¨ï¼šæœªçŸ¥ å˜åŒ–ï¼šæ ¹æ®æˆ‘çš„è§‚å¯Ÿæ˜¯ä¸€å¤©å˜åŒ–ä¸€æ¬¡ åŠ å¯†ï¼šæ˜¯</li>
<li>WEATHER_CITY ä½œç”¨ï¼šæ ‡è®°åŸå¸‚ å˜åŒ–ï¼šä¸å˜åŒ–|åŠ å¯†ï¼šæ˜¯(urlencode)</li>
<li>tt_webid ä½œç”¨ï¼šæœªçŸ¥ å˜åŒ–ï¼šåŒä¸Štt_webidä¸€æ ·|åŠ å¯†ï¼šæ˜¯</li>
<li>csrftoken ä½œç”¨ï¼šç”¨äºcsrf å˜åŒ–ï¼šåŒä¸Š åŠ å¯†ï¼šæ˜¯</li>
</ul>
<p>è¿™æ ·å°±åˆ†æå®Œæ•´ä¸ªç½‘ç«™äº†ï¼Œä¸‹é¢å¼€å§‹å®æˆ˜ã€‚</p>
<h1 id="çˆ¬å–ä»Šæ—¥å¤´æ¡"><a href="#çˆ¬å–ä»Šæ—¥å¤´æ¡" class="headerlink" title="çˆ¬å–ä»Šæ—¥å¤´æ¡"></a>çˆ¬å–ä»Šæ—¥å¤´æ¡</h1><p>çŸ¥é“è¿™äº›åŠ å¯†å‚æ•°åå°±å¼€å§‹å¯¹åŠ å¯†å‚æ•°è¿›è¡Œç ´è§£</p>
<h3 id="1-ç ´è§£aså’Œcp"><a href="#1-ç ´è§£aså’Œcp" class="headerlink" title="1.ç ´è§£aså’Œcp"></a>1.ç ´è§£aså’Œcp</h3><p>é¦–å…ˆæˆ‘ä»¬å·²ç»çŸ¥é“äº†æ¯æ¬¡çš„è®¿é—®å‚æ•°éƒ½åœ¨å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆæ‰¾å‡ºè¿™äº›å‚æ•°çš„åŠ å¯†ä»£ç ï¼Œä¹Ÿå°±æ˜¯jsä»£ç ã€‚</p>
<p>æœç´¢jsæ–‡ä»¶ä¸­å¸¦æœ‰<code>as</code>æˆ–<code>cp</code>æˆ–<code>_signature</code>å­—ç¬¦çš„æ–‡ä»¶ï¼Œç„¶åå†åˆ†æä»£ç æ˜¯æ€ä¹ˆæ„æˆçš„ã€‚</p>
<p>æœç´¢æ–¹æ³•ï¼š<br><img src="https://img-blog.csdnimg.cn/20191101170258637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æœç´¢æ–¹æ³•"><br>è¿›å…¥åå†æŒ‰Ctrl+Få†æ¬¡æœç´¢<code>_signature</code>ï¼Œå°±å¯ä»¥çœ‹åˆ°å‚æ•°çš„åŠ å¯†æ–¹æ³•äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101170441760.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æœç´¢"><br>è¿™æ ·å°±èƒ½æ‰¾åˆ°è¿™ä¸²åŠ å¯†ä»£ç äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e, i = ascp.getHoney(), t = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">window</span>.TAC &amp;&amp; (t = TAC.sign(userInfo.id + <span class="string">""</span> + d.params.max_behot_time)),</span><br><span class="line">    e = _.extend(&#123;&#125;, d.params, &#123;</span><br><span class="line">        <span class="keyword">as</span>: i.as,</span><br><span class="line">        cp: i.cp,</span><br><span class="line">        _signature: t</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­==i.as==å’Œ==i.cp==åˆ†åˆ«å¯¹åº”==as==å’Œ==cp==ï¼Œè€Œ==i==æ˜¯ç”±<code>ascp.getHoney()</code>è¿™ä»£ç è¿”å›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»§ç»­æ‰¾<code>ascp.getHoney</code>,ç»§ç»­æœç´¢<code>getHoney</code>å‡½æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101171111280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æœç´¢"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">i.getHoney = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e = <span class="built_in">Math</span>.floor((<span class="keyword">new</span> <span class="built_in">Date</span>).getTime() / <span class="number">1e3</span>)</span><br><span class="line">      , i = e.toString(<span class="number">16</span>).toUpperCase()</span><br><span class="line">      , t = md5(e).toString().toUpperCase();</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">8</span> != i.length)</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="keyword">as</span>: <span class="string">"479BB4B7254C150"</span>,</span><br><span class="line">            cp: <span class="string">"7E0AC8874BB0985"</span></span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> o = t.slice(<span class="number">0</span>, <span class="number">5</span>), n = t.slice(<span class="number">-5</span>), a = <span class="string">""</span>, s = <span class="number">0</span>; <span class="number">5</span> &gt; s; s++)</span><br><span class="line">        a += o[s] + i[s];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> r = <span class="string">""</span>, l = <span class="number">0</span>; <span class="number">5</span> &gt; l; l++)</span><br><span class="line">        r += i[l + <span class="number">3</span>] + n[l];</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="keyword">as</span>: <span class="string">"A1"</span> + a + i.slice(<span class="number">-3</span>),</span><br><span class="line">        cp: i.slice(<span class="number">0</span>, <span class="number">3</span>) + r + <span class="string">"E1"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™ä¸²JSä»£ç å°†ä»–è½¬æ¢ä¸ºPythonä»£ç å°±å¯ä»¥å¾—å‡º<code>as</code>å’Œ<code>cp</code>çš„å€¼äº†ï¼Œä¸‹é¢ç»™å‡ºPythonä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math,time,hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHoney</span><span class="params">()</span>:</span></span><br><span class="line">    e = math.floor(int(str(time.time() * <span class="number">1000</span>).split(<span class="string">'.'</span>)[<span class="number">0</span>]) / <span class="number">1e3</span>)	<span class="comment">#è·å–13ä½æ¯«ç§’æ•°ç„¶åé™¤äº1e3å†å‘ä¸‹å–æ•´</span></span><br><span class="line">    i = str(<span class="string">'%X'</span> % e)	<span class="comment">#è½¬æ¢eä¸º16è¿›åˆ¶</span></span><br><span class="line">    m5 = hashlib.md5()</span><br><span class="line">    m5.update(str(e).encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    t = str(m5.hexdigest()).upper()	<span class="comment">#è¿›è¡Œmd5åŠ å¯†</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">8</span> != len(i):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">'as'</span>:<span class="string">'479BB4B7254C150'</span>,<span class="string">'cp'</span>:<span class="string">'7E0AC8874BB0985'</span>&#125;</span><br><span class="line">    o = t[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line">    n = t[<span class="number">-5</span>:]</span><br><span class="line">    a = <span class="string">""</span></span><br><span class="line">    r = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>):	<span class="comment">#äº¤æ¢å­—ç¬¦ä¸²</span></span><br><span class="line">        a += o[x] + i[x]</span><br><span class="line">        r += i[x + <span class="number">3</span>] + n[x]</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">'as'</span>:<span class="string">"A1"</span> + a + i[<span class="number">-3</span>:],<span class="string">'cp'</span>:i[<span class="number">0</span>:<span class="number">3</span>] + r + <span class="string">"E1"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	print(getHoney())</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20191101173413781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="è¾“å‡ºç»“æœ"></p>
<h3 id="2-ç ´è§£-signature"><a href="#2-ç ´è§£-signature" class="headerlink" title="2.ç ´è§£_signature"></a>2.ç ´è§£_signature</h3><p>æ ¹æ®ä¸Šé¢ç ´è§£==as==å’Œ==cp==æ—¶å€™çš„æˆªå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹è§ç”Ÿæˆ<code>_signature</code>çš„å€¼æ˜¯==t==ï¼Œè€Œç”Ÿæˆtçš„æ–¹æ³•æ˜¯<code>TAC.sign(userInfo.id + &quot;&quot; + d.params.max_behot_time)</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœç´¢<code>TAC.sign()</code>æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101170441760.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æœç´¢"><br>æœç´¢å®Œæˆä¹‹åå‘ç°æ˜¯å¾ˆå¤§ä¸€ä¸²æ··æ·†åŠ å¯†åçš„æ–¹æ³•å®ç°çš„TACï¼Œæƒ³è¦ç ´è§£éœ€è¦èŠ±å¾ˆå¤šæ—¶é—´å»çœ‹ä»£ç ï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å°±ç”¨execjsç›´æ¥æ‰§è¡Œè¿™ä¸²ä»£ç å°±å¯ä»¥äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101174311270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>jsæºä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'e(e,a,r)&#123;(b[e]||(b[e]=t("x,y","x "+e+" y")(r,a)&#125;a(e,a,r)&#123;(k[r]||(k[r]=t("x,y","new x[y]("+Array(r+1).join(",x[y]")(1)+")")(e,a)&#125;r(e,a,r)&#123;n,t,s=&#123;&#125;,b=s.d=r?r.d+1:0;for(s["$"+b]=s,t=0;t&lt;b;t)s[n="$"+t]=r[n];for(t=0,b=s=a;t&lt;b;t)s[t]=a[t];c(e,0,s)&#125;c(t,b,k)&#123;u(e)&#123;v[x]=e&#125;f&#123;g=,ting(bg)&#125;l&#123;try&#123;y=c(t,b,k)&#125;catch(e)&#123;h=e,y=l&#125;&#125;for(h,y,d,g,v=[],x=0;;)switch(g=)&#123;case 1:u(!)4:f5:u((e)&#123;a=0,r=e;&#123;c=a&lt;r;c&amp;&amp;u(e[a]),c&#125;&#125;(6:y=,u((y8:if(g=,lg,g=,y===c)b+=g;else if(y!==l)y9:c10:u(s(11:y=,u(+y)12:for(y=f,d=[],g=0;g&lt;y;g)d[g]=y.charCodeAt(g)^g+y;u(String.fromCharCode.apply(null,d13:y=,h=delete [y]14:59:u((g=)?(y=x,v.slice(x-=g,y:[])61:u([])62:g=,k[0]=65599*k[0]+k[1].charCodeAt(g)&gt;&gt;&gt;065:h=,y=,[y]=h66:u(e(t[b],,67:y=,d=,u((g=).x===c?r(g.y,y,k):g.apply(d,y68:u(e((g=t[b])&lt;"&lt;"?(b--,f):g+g,,70:u(!1)71:n72:+f73:u(parseInt(f,3675:if()&#123;bcase 74:g=&lt;&lt;16&gt;&gt;16g76:u(k[])77:y=,u([y])78:g=,u(a(v,x-=g+1,g79:g=,u(k["$"+g])81:h=,[f]=h82:u([f])83:h=,k[]=h84:!085:void 086:u(v[x-1])88:h=,y=,h,y89:u(&#123;e&#123;r(e.y,arguments,k)&#125;e.y=f,e.x=c,e&#125;)90:null91:h93:h=0:;default:u((g&lt;&lt;16&gt;&gt;16)-16)&#125;&#125;n=this,t=n.Function,s=Object.keys||(e)&#123;a=&#123;&#125;,r=0;for(c in e)a[r]=c;a=r,a&#125;,b=&#123;&#125;,k=&#123;&#125;;r'</span>.replace(<span class="regexp">/[-]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> e[<span class="number">15</span> &amp; i.charCodeAt(<span class="number">0</span>)]</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;(<span class="string">"v[x++]=v[--x]t.charCodeAt(b++)-32function return ))++.substrvar .length(),b+=;break;case ;break&#125;"</span>.split(<span class="string">""</span>)))()(<span class="string">'gr$Daten Ğ˜b/s!l yÍ’yÄ¹g,(lfi~ah`&#123;mv,-n|jqewVxp&#123;rvmmx,&amp;effkx[!cs"l".Pq%widthl"@q&amp;heightl"vr*getContextx$"2d[!cs#l#,*;?|u.|uc&#123;uq$fontl#vr(fillTextx$$é¾˜à¸‘à¸ ê²½2&lt;[#c&#125;l#2q*shadowBlurl#1q-shadowOffsetXl#$$limeq+shadowColorl#vr#arcx88802[%c&#125;l#vr&amp;strokex[ c&#125;l"v,)&#125;eOmyoZB]mx[ cs!0s$l$Pb&lt;k7l l!r&amp;lengthb%^l$1+s$jl  s#i$1ek1s$gr#tack4)zgr#tac$! +0o![#cj?o ]!l$b%s"o ]!l"l$b*b^0d#&gt;&gt;&gt;s!0s%yA0s"l"l!r&amp;lengthb&lt;k+l"^l"1+s"jl  s&amp;l&amp;z0l!$ +["cs\'(0l#i\'1ps9wxb&amp;s() &amp;&#123;s)/s(gr&amp;Stringr,fromCharCodes)0s*yWl ._b&amp;s o!])l l Jb&lt;k$.aj;l .Tb&lt;k$.gj/l .^b&lt;k&amp;i"-4j!+&amp; s+yPo!]+s!l!l Hd&gt;&amp;l!l Bd&gt;&amp;+l!l &lt;d&gt;&amp;+l!l 6d&gt;&amp;+l!l &amp;+ s,y=o!o!]/q"13o!l q"10o!],l 2d&gt;&amp; s.&#123;s-yMo!o!]0q"13o!]*Ld&lt;l 4d#&gt;&gt;&gt;b|s!o!l q"10o!],l!&amp; s/yIo!o!].q"13o!],o!]*Jd&lt;l 6d#&gt;&gt;&gt;b|&amp;o!]+l &amp;+ s0l-l!&amp;l-l!i\'1z141z4b/@d&lt;l"b|&amp;+l-l(l!b^&amp;+l-l&amp;zl\'g,)gk&#125;ejo&#123;cm,)|yn~Lij~em["cl$b%@d&lt;l&amp;zl\'l $ +["cl$b%b|&amp;+l-l%8d&lt;@b|l!b^&amp;+ q$sign '</span>, [TAC = &#123;&#125;]);</span><br></pre></td></tr></table></figure>

<p>ç”±äºpythonæ²¡æœ‰æµè§ˆå™¨çš„userAgentï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å¯¹ä»£ç è¿›è¡Œä¸€ç‚¹æ”¹å˜ï¼Œè®©ä»–æ¥é€‚åº”æˆ‘ä»¬pythonä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">tac</span>(<span class="params">userid</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">Function</span>(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">        global.navigator=&#123;&#125;;	<span class="comment">//å£°æ˜ä¸€ä¸ªæµè§ˆå™¨å¾—navigator</span></span><br><span class="line">        global.navigator.userAgent = <span class="string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36"</span>;	<span class="comment">//ç»™navigatoræ·»åŠ ä¸€ä¸ªuserAgentï¼Œè®©ä¸‹é¢æ··æ·†èƒ½å¤Ÿæ­£å¸¸è¯»å–userAgentä¿¡æ¯ï¼Œæ­¤userAgentå¿…é¡»å’Œpythonä»£ç ä¸­çš„headersé‡Œçš„userAgentä¸€æ¨¡ä¸€æ ·ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'e(e,a,r)&#123;(b[e]||(b[e]=t("x,y","x "+e+" y")(r,a)&#125;a(e,a,r)&#123;(k[r]||(k[r]=t("x,y","new x[y]("+Array(r+1).join(",x[y]")(1)+")")(e,a)&#125;r(e,a,r)&#123;n,t,s=&#123;&#125;,b=s.d=r?r.d+1:0;for(s["$"+b]=s,t=0;t&lt;b;t)s[n="$"+t]=r[n];for(t=0,b=s=a;t&lt;b;t)s[t]=a[t];c(e,0,s)&#125;c(t,b,k)&#123;u(e)&#123;v[x]=e&#125;f&#123;g=,ting(bg)&#125;l&#123;try&#123;y=c(t,b,k)&#125;catch(e)&#123;h=e,y=l&#125;&#125;for(h,y,d,g,v=[],x=0;;)switch(g=)&#123;case 1:u(!)4:f5:u((e)&#123;a=0,r=e;&#123;c=a&lt;r;c&amp;&amp;u(e[a]),c&#125;&#125;(6:y=,u((y8:if(g=,lg,g=,y===c)b+=g;else if(y!==l)y9:c10:u(s(11:y=,u(+y)12:for(y=f,d=[],g=0;g&lt;y;g)d[g]=y.charCodeAt(g)^g+y;u(String.fromCharCode.apply(null,d13:y=,h=delete [y]14:59:u((g=)?(y=x,v.slice(x-=g,y:[])61:u([])62:g=,k[0]=65599*k[0]+k[1].charCodeAt(g)&gt;&gt;&gt;065:h=,y=,[y]=h66:u(e(t[b],,67:y=,d=,u((g=).x===c?r(g.y,y,k):g.apply(d,y68:u(e((g=t[b])&lt;"&lt;"?(b--,f):g+g,,70:u(!1)71:n72:+f73:u(parseInt(f,3675:if()&#123;bcase 74:g=&lt;&lt;16&gt;&gt;16g76:u(k[])77:y=,u([y])78:g=,u(a(v,x-=g+1,g79:g=,u(k["$"+g])81:h=,[f]=h82:u([f])83:h=,k[]=h84:!085:void 086:u(v[x-1])88:h=,y=,h,y89:u(&#123;e&#123;r(e.y,arguments,k)&#125;e.y=f,e.x=c,e&#125;)90:null91:h93:h=0:;default:u((g&lt;&lt;16&gt;&gt;16)-16)&#125;&#125;n=this,t=n.Function,s=Object.keys||(e)&#123;a=&#123;&#125;,r=0;for(c in e)a[r]=c;a=r,a&#125;,b=&#123;&#125;,k=&#123;&#125;;r'</span>.replace(<span class="regexp">/[-]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> e[<span class="number">15</span> &amp; i.charCodeAt(<span class="number">0</span>)]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;(<span class="string">"v[x++]=v[--x]t.charCodeAt(b++)-32function return ))++.substrvar .length(),b+=;break;case ;break&#125;"</span>.split(<span class="string">""</span>)))()(<span class="string">'gr$Daten Ğ˜b/s!l yÍ’yÄ¹g,(lfi~ah`&#123;mv,-n|jqewVxp&#123;rvmmx,&amp;effkx[!cs"l".Pq%widthl"@q&amp;heightl"vr*getContextx$"2d[!cs#l#,*;?|u.|uc&#123;uq$fontl#vr(fillTextx$$é¾˜à¸‘à¸ ê²½2&lt;[#c&#125;l#2q*shadowBlurl#1q-shadowOffsetXl#$$limeq+shadowColorl#vr#arcx88802[%c&#125;l#vr&amp;strokex[ c&#125;l"v,)&#125;eOmyoZB]mx[ cs!0s$l$Pb&lt;k7l l!r&amp;lengthb%^l$1+s$jl  s#i$1ek1s$gr#tack4)zgr#tac$! +0o![#cj?o ]!l$b%s"o ]!l"l$b*b^0d#&gt;&gt;&gt;s!0s%yA0s"l"l!r&amp;lengthb&lt;k+l"^l"1+s"jl  s&amp;l&amp;z0l!$ +["cs\'(0l#i\'1ps9wxb&amp;s() &amp;&#123;s)/s(gr&amp;Stringr,fromCharCodes)0s*yWl ._b&amp;s o!])l l Jb&lt;k$.aj;l .Tb&lt;k$.gj/l .^b&lt;k&amp;i"-4j!+&amp; s+yPo!]+s!l!l Hd&gt;&amp;l!l Bd&gt;&amp;+l!l &lt;d&gt;&amp;+l!l 6d&gt;&amp;+l!l &amp;+ s,y=o!o!]/q"13o!l q"10o!],l 2d&gt;&amp; s.&#123;s-yMo!o!]0q"13o!]*Ld&lt;l 4d#&gt;&gt;&gt;b|s!o!l q"10o!],l!&amp; s/yIo!o!].q"13o!],o!]*Jd&lt;l 6d#&gt;&gt;&gt;b|&amp;o!]+l &amp;+ s0l-l!&amp;l-l!i\'1z141z4b/@d&lt;l"b|&amp;+l-l(l!b^&amp;+l-l&amp;zl\'g,)gk&#125;ejo&#123;cm,)|yn~Lij~em["cl$b%@d&lt;l&amp;zl\'l $ +["cl$b%b|&amp;+l-l%8d&lt;@b|l!b^&amp;+ q$sign '</span>, [TAC = &#123;&#125;]);</span><br><span class="line">    <span class="keyword">var</span> signs = TAC.sign(userid);</span><br><span class="line">    <span class="keyword">return</span> signs</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰§è¡Œä¸Šé¢è¿™ä¸²jsä»£ç å‰è¯·å…ˆæ›´æ¢ä¸€ä¸ª<code>jsç¯å¢ƒ</code>ï¼Œé»˜è®¤<code>execjs</code>ä½¿ç”¨çš„æ˜¯windowsç³»ç»Ÿçš„<code>JScript</code>ï¼Œè¿™ä¸ª<code>jsç¯å¢ƒ</code>ä¸é€‚åˆè¿™ä¸²ä»£ç ï¼Œæ‰€ä»¥å®‰è£…ä¸€ä¸ª<code>nodejsç¯å¢ƒ</code>ï¼Œç„¶åé‡å¯ä¸€ä¸‹<code>pycharm</code>å°±å¯ä»¥äº†ã€‚<br>æŠŠè¿™ä¸²jsä»£ç ä¿å­˜ä¸ºjsæ–‡ä»¶ï¼Œç„¶åç”¨pythonæ¥è¿›è¡Œæ‰§è¡Œï¼Œä¸‹é¢è½¬æ¢ä¸ºpythonä»£ç ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> execjs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_signature</span><span class="params">(user_id,max_behot_time)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'newsign.js'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        jsData = f.read()</span><br><span class="line">    execjs.get()</span><br><span class="line">    ctx = execjs.compile(jsData).call(<span class="string">'tac'</span>,str(user_id) + str(max_behot_time))  <span class="comment">#å¤åŸTAC.sign(userInfo.id + "" + i.param.max_behot_time)</span></span><br><span class="line">    <span class="keyword">return</span> ctx</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	user_id = <span class="string">'https://www.toutiao.com/c/user/3410443345/#mid=3413306633'</span>.split(<span class="string">'/'</span>)[<span class="number">-2</span>]	<span class="comment">#è·å–user_id</span></span><br><span class="line">	print(get_signature(user_id,<span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20191101175214195.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™ä¸‰ä¸ªåŠ å¯†å‚æ•°ç ´è§£å®Œäº†ï¼Œé‚£ä¹ˆå°±å¤§åŠŸå‘Šæˆäº†ã€‚</p>
<h3 id="3-è·å–æ•°æ®"><a href="#3-è·å–æ•°æ®" class="headerlink" title="3.è·å–æ•°æ®"></a>3.è·å–æ•°æ®</h3><p>ä¸Šé¢å·²ç»ä»‹ç»å®Œäº†æ‰€æœ‰çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å¤šè¯´åºŸè¯äº†ï¼Œç›´æ¥ä¸Šä»£ç äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,math,time,hashlib,execjs,json</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–_signatureå‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_signature</span><span class="params">(user_id,max_behot_time)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'newsign.js'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        jsData = f.read()</span><br><span class="line">    execjs.get()</span><br><span class="line">    ctx = execjs.compile(jsData).call(<span class="string">'tac'</span>,str(user_id) + str(max_behot_time))  <span class="comment">#å¤åŸTAC.sign(userInfo.id + "" + i.param.max_behot_time)</span></span><br><span class="line">    <span class="keyword">return</span> ctx</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–aså’Œcpå‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHoney</span><span class="params">()</span>:</span></span><br><span class="line">    e = math.floor(int(str(time.time() * <span class="number">1000</span>).split(<span class="string">'.'</span>)[<span class="number">0</span>]) / <span class="number">1e3</span>)</span><br><span class="line">    i = str(<span class="string">'%X'</span> % e)</span><br><span class="line">    m1 = hashlib.md5()</span><br><span class="line">    m1.update(str(e).encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    t = str(m1.hexdigest()).upper()</span><br><span class="line">    <span class="keyword">if</span> <span class="number">8</span> != len(i):</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">'as'</span>:<span class="string">'479BB4B7254C150'</span>,</span><br><span class="line">            <span class="string">'cp'</span>:<span class="string">'7E0AC8874BB0985'</span></span><br><span class="line">        &#125;</span><br><span class="line">    o = t[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line">    n = t[<span class="number">-5</span>:]</span><br><span class="line">    a = <span class="string">""</span></span><br><span class="line">    r = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        a += o[x] + i[x]</span><br><span class="line">        r += i[x + <span class="number">3</span>] + n[x]</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">'as'</span>:<span class="string">"A1"</span> + a + i[<span class="number">-3</span>:],<span class="string">'cp'</span>:i[<span class="number">0</span>:<span class="number">3</span>] + r + <span class="string">"E1"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–ç½‘ç«™apiçš„jsonæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_json</span><span class="params">(user_id,max_behot_time,as_cp,signature,page_type)</span>:</span></span><br><span class="line">    <span class="comment">#page_typeä¸º0æ˜¯çˆ¬å–è§†é¢‘å†…å®¹ï¼Œä¸º1æ˜¯çˆ¬å–æ–‡ç« å†…å®¹</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'authority'</span>: <span class="string">'www.toutiao.com'</span>,</span><br><span class="line">        <span class="string">'method'</span>: <span class="string">'GET'</span>,</span><br><span class="line">        <span class="string">'path'</span>: <span class="string">'/c/user/article/?page_type=&#123;page_type&#125;&amp;user_id=&#123;user_id&#125;&amp;max_behot_time=&#123;max_behot_time&#125;&amp;count=20&amp;as=&#123;as&#125;&amp;cp=&#123;cp&#125;&amp;_signature=&#123;signature&#125;'</span>.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp),</span><br><span class="line">        <span class="string">'scheme'</span>: <span class="string">'https'</span>,</span><br><span class="line">        <span class="string">'accept'</span>: <span class="string">'application/json, text/javascript'</span>,</span><br><span class="line">        <span class="string">'accept-encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</span><br><span class="line">        <span class="string">'accept-language'</span>: <span class="string">'zh-CN,zh;q=0.9'</span>,</span><br><span class="line">        <span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">        <span class="string">'cookie'</span>: <span class="string">'tt_webid=6753859293584737805; WEATHER_CITY=%E5%8C%97%E4%BA%AC; tt_webid=6753859293584737805; csrftoken=60ed6e0a8271872b7d0ab6b864bd6611; __tasessionId=eqzqwzzav1572574450156'</span>,</span><br><span class="line">        <span class="string">'referer'</span>: <span class="string">'https://www.toutiao.com/c/user/3410443345/'</span>,</span><br><span class="line">        <span class="string">'sec-fetch-mode'</span>: <span class="string">'cors'</span>,</span><br><span class="line">        <span class="string">'sec-fetch-site'</span>: <span class="string">'same-origin'</span>,</span><br><span class="line">        <span class="string">'user-agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36'</span>,</span><br><span class="line">        <span class="string">'x-requested-with'</span>: <span class="string">'XMLHttpRequest'</span></span><br><span class="line">    &#125;</span><br><span class="line">    url = <span class="string">'https://www.toutiao.com/c/user/article/?page_type=&#123;page_type&#125;&amp;user_id=&#123;user_id&#125;&amp;max_behot_time=&#123;max_behot_time&#125;&amp;count=20&amp;as=&#123;as&#125;&amp;cp=&#123;cp&#125;&amp;_signature=&#123;signature&#125;'</span>.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp)</span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    resp_json = json.loads(response.text)</span><br><span class="line">    <span class="keyword">return</span> resp_json</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'https://www.toutiao.com/c/user/3410443345/#mid=3413306633'</span>  <span class="comment"># urlä¸ºç”¨æˆ·æ–‡ç« å’Œè§†é¢‘çš„æº</span></span><br><span class="line">    user_id = url.split(<span class="string">'/'</span>)[<span class="number">-2</span>]  <span class="comment"># è·å–ç”¨æˆ·user_idï¼Œç­‰åŒäºjsä¸­çš„userInfo.id</span></span><br><span class="line">    max_behot_time = <span class="number">0</span>  <span class="comment"># _signatureå‚æ•°ç”Ÿæˆéœ€è¦ï¼Œå¹¶ä¸”èµ–åŠ è½½æ—¶ä¹Ÿéœ€è¦æ­¤å‚æ•°</span></span><br><span class="line">    page_type = <span class="number">1</span>   <span class="comment">#0ä¸ºæ–‡ç« ï¼Œ1ä¸ºè§†é¢‘</span></span><br><span class="line">    as_cp = getHoney()  <span class="comment">#è·å–aså’Œcpå€¼</span></span><br><span class="line">    signature = get_signature(user_id,max_behot_time) <span class="comment">#è·å–_signatureå€¼</span></span><br><span class="line">    toutiao_json = get_json(user_id,max_behot_time,as_cp,signature,page_type)   <span class="comment">#è·å–ä»Šæ—¥å¤´æ¡æ–‡ç« æ•°æ®</span></span><br><span class="line">    print(json.dumps(toutiao_json,ensure_ascii=<span class="literal">False</span>,indent=<span class="number">4</span>,sort_keys=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20191101181706930.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="æ¼”ç¤ºå›¾"></p>
<h3 id="4-è·å–èµ–åŠ è½½æ•°æ®-å®Œæ•´ç‰ˆ"><a href="#4-è·å–èµ–åŠ è½½æ•°æ®-å®Œæ•´ç‰ˆ" class="headerlink" title="4.è·å–èµ–åŠ è½½æ•°æ®(å®Œæ•´ç‰ˆ)"></a>4.è·å–èµ–åŠ è½½æ•°æ®(å®Œæ•´ç‰ˆ)</h3><p><img src="https://img-blog.csdnimg.cn/20191101182201451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šå›¾å°±æ˜¯è·å–åˆ°ç©ºæ•°æ®ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜åŠ äº†tryæ¥è¿›è¡Œæ§åˆ¶ã€‚<br><img src="https://img-blog.csdnimg.cn/20191101183332541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMjc5MDc3,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å®Œæ•´ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,math,time,hashlib,execjs,json</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–_signatureå‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_signature</span><span class="params">(user_id,max_behot_time)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'newsign.js'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        jsData = f.read()</span><br><span class="line">    execjs.get()</span><br><span class="line">    ctx = execjs.compile(jsData).call(<span class="string">'tac'</span>,str(user_id) + str(max_behot_time))  <span class="comment">#å¤åŸTAC.sign(userInfo.id + "" + i.param.max_behot_time)</span></span><br><span class="line">    <span class="keyword">return</span> ctx</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–aså’Œcpå‚æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHoney</span><span class="params">()</span>:</span></span><br><span class="line">    e = math.floor(int(str(time.time() * <span class="number">1000</span>).split(<span class="string">'.'</span>)[<span class="number">0</span>]) / <span class="number">1e3</span>)</span><br><span class="line">    i = str(<span class="string">'%X'</span> % e)</span><br><span class="line">    m1 = hashlib.md5()</span><br><span class="line">    m1.update(str(e).encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    t = str(m1.hexdigest()).upper()</span><br><span class="line">    <span class="keyword">if</span> <span class="number">8</span> != len(i):</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">'as'</span>:<span class="string">'479BB4B7254C150'</span>,</span><br><span class="line">            <span class="string">'cp'</span>:<span class="string">'7E0AC8874BB0985'</span></span><br><span class="line">        &#125;</span><br><span class="line">    o = t[<span class="number">0</span>:<span class="number">5</span>]</span><br><span class="line">    n = t[<span class="number">-5</span>:]</span><br><span class="line">    a = <span class="string">""</span></span><br><span class="line">    r = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        a += o[x] + i[x]</span><br><span class="line">        r += i[x + <span class="number">3</span>] + n[x]</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">'as'</span>:<span class="string">"A1"</span> + a + i[<span class="number">-3</span>:],<span class="string">'cp'</span>:i[<span class="number">0</span>:<span class="number">3</span>] + r + <span class="string">"E1"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–ç½‘ç«™apiçš„jsonæ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_json</span><span class="params">(user_id,max_behot_time,as_cp,signature,page_type)</span>:</span></span><br><span class="line">    <span class="comment">#page_typeä¸º0æ˜¯çˆ¬å–è§†é¢‘å†…å®¹ï¼Œä¸º1æ˜¯çˆ¬å–æ–‡ç« å†…å®¹</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'authority'</span>: <span class="string">'www.toutiao.com'</span>,</span><br><span class="line">        <span class="string">'method'</span>: <span class="string">'GET'</span>,</span><br><span class="line">        <span class="string">'path'</span>: <span class="string">'/c/user/article/?page_type=&#123;page_type&#125;&amp;user_id=&#123;user_id&#125;&amp;max_behot_time=&#123;max_behot_time&#125;&amp;count=20&amp;as=&#123;as&#125;&amp;cp=&#123;cp&#125;&amp;_signature=&#123;signature&#125;'</span>.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp),</span><br><span class="line">        <span class="string">'scheme'</span>: <span class="string">'https'</span>,</span><br><span class="line">        <span class="string">'accept'</span>: <span class="string">'application/json, text/javascript'</span>,</span><br><span class="line">        <span class="string">'accept-encoding'</span>: <span class="string">'gzip, deflate, br'</span>,</span><br><span class="line">        <span class="string">'accept-language'</span>: <span class="string">'zh-CN,zh;q=0.9'</span>,</span><br><span class="line">        <span class="string">'content-type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>,</span><br><span class="line">        <span class="string">'cookie'</span>: <span class="string">'tt_webid=6753859293584737805; WEATHER_CITY=%E5%8C%97%E4%BA%AC; tt_webid=6753859293584737805; csrftoken=60ed6e0a8271872b7d0ab6b864bd6611; __tasessionId=eqzqwzzav1572574450156'</span>,</span><br><span class="line">        <span class="string">'referer'</span>: <span class="string">'https://www.toutiao.com/c/user/3410443345/'</span>,</span><br><span class="line">        <span class="string">'sec-fetch-mode'</span>: <span class="string">'cors'</span>,</span><br><span class="line">        <span class="string">'sec-fetch-site'</span>: <span class="string">'same-origin'</span>,</span><br><span class="line">        <span class="string">'user-agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.70 Safari/537.36'</span>,</span><br><span class="line">        <span class="string">'x-requested-with'</span>: <span class="string">'XMLHttpRequest'</span></span><br><span class="line">    &#125;</span><br><span class="line">    url = <span class="string">'https://www.toutiao.com/c/user/article/?page_type=&#123;page_type&#125;&amp;user_id=&#123;user_id&#125;&amp;max_behot_time=&#123;max_behot_time&#125;&amp;count=20&amp;as=&#123;as&#125;&amp;cp=&#123;cp&#125;&amp;_signature=&#123;signature&#125;'</span>.format(page_type=page_type,user_id=user_id,max_behot_time=max_behot_time,signature=signature, **as_cp)</span><br><span class="line">    response = requests.get(url, headers=headers)</span><br><span class="line">    resp_json = json.loads(response.text)</span><br><span class="line">    <span class="keyword">return</span> resp_json</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    url = <span class="string">'https://www.toutiao.com/c/user/3410443345/#mid=3413306633'</span>  <span class="comment"># urlä¸ºç”¨æˆ·æ–‡ç« å’Œè§†é¢‘çš„æº</span></span><br><span class="line">    user_id = url.split(<span class="string">'/'</span>)[<span class="number">-2</span>]  <span class="comment"># è·å–ç”¨æˆ·user_idï¼Œç­‰åŒäºjsä¸­çš„userInfo.id</span></span><br><span class="line">    max_behot_time = <span class="number">0</span>  <span class="comment"># _signatureå‚æ•°ç”Ÿæˆéœ€è¦ï¼Œå¹¶ä¸”èµ–åŠ è½½æ—¶ä¹Ÿéœ€è¦æ­¤å‚æ•°</span></span><br><span class="line">    isDown = <span class="literal">True</span>  <span class="comment"># ä¸€ç›´è·å–æ•°æ®</span></span><br><span class="line">    page_type = <span class="number">1</span>   <span class="comment">#0ä¸ºè§†é¢‘ï¼Œ1ä¸ºæ–‡ç« </span></span><br><span class="line">    <span class="keyword">while</span> isDown:	<span class="comment">#è§£å†³èµ–åŠ è½½é—®é¢˜</span></span><br><span class="line">        as_cp = getHoney()</span><br><span class="line">        signature = get_signature(user_id, max_behot_time)</span><br><span class="line">        toutiao_json = get_json(user_id, max_behot_time, as_cp, signature,page_type)</span><br><span class="line">        <span class="comment"># ç”±äºä»Šæ—¥å¤´æ¡çš„åçˆ¬è™«æœºåˆ¶ï¼Œæœ‰æ—¶ä¼šè·å–åˆ°ç©ºçš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ç”¨tryæ¥æ§åˆ¶ï¼Œä¸€èˆ¬æ¯”ä¾‹æ˜¯3ï¼š1æ‰€ä»¥æ˜¯è®¿é—®3æ¬¡æœ‰ä¸€æ¬¡è·å¾—æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> page_type:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                max_behot_time = toutiao_json[<span class="string">'next'</span>][<span class="string">'max_behot_time'</span>]     <span class="comment">#æ•°æ®ä¸ºç©ºå°±æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ä»è€Œå¼•å‘try</span></span><br><span class="line">                print(<span class="string">'æ–‡ç« æ•°æ®ï¼š%s'</span> % str(toutiao_json))</span><br><span class="line">                has_more = toutiao_json[<span class="string">'has_more'</span>] <span class="comment">#è·å–æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µæ•°æ®</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> has_more:    <span class="comment">#ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ²¡æœ‰ä¸‹ä¸€é¡µäº†</span></span><br><span class="line">                    isDown = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                max_behot_time = toutiao_json[<span class="string">'next'</span>][<span class="string">'max_behot_time'</span>]  <span class="comment"># æ•°æ®ä¸ºç©ºå°±æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ä»è€Œå¼•å‘try</span></span><br><span class="line">                print(<span class="string">'è§†é¢‘æ•°æ®ï¼š%s'</span> % str(toutiao_json))</span><br><span class="line">                has_more = toutiao_json[<span class="string">'has_more'</span>] <span class="comment">#è·å–æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€é¡µæ•°æ®</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> has_more:    <span class="comment">#ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ²¡æœ‰ä¸‹ä¸€é¡µäº†</span></span><br><span class="line">                    isDown = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<h2 id="å£°æ˜ï¼šæœ¬æ–‡ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œè¿è€…åæœè‡ªè´Ÿã€‚"><a href="#å£°æ˜ï¼šæœ¬æ–‡ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œè¿è€…åæœè‡ªè´Ÿã€‚" class="headerlink" title="å£°æ˜ï¼šæœ¬æ–‡ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œè¿è€…åæœè‡ªè´Ÿã€‚"></a>å£°æ˜ï¼šæœ¬æ–‡ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œè¿è€…åæœè‡ªè´Ÿã€‚</h2><h2 id="gitee-â€˜https-gitee-com-fumingyao-todays-headlines-39"><a href="#gitee-â€˜https-gitee-com-fumingyao-todays-headlines-39" class="headerlink" title="gitee : â€˜https://gitee.com/fumingyao/todays_headlines&#39;"></a>gitee : â€˜<a href="https://gitee.com/fumingyao/todays_headlines&#39;" target="_blank" rel="noopener">https://gitee.com/fumingyao/todays_headlines&#39;</a></h2>
      </div>
    </div>
  </div>
</div>
<div class="lx-navigation">
	<div class="lx-cover prev lx-cover-sm" style="background-image: url(/images/footer_1.jpg)">
		<div class="overlay"></div>
		<a class="copy" href="#">
			<div class="display-t">
				<div class="display-tc">
					<div>
						<span>Next</span>
						<h3>æ²¡æœ‰æ›´æ–°çš„æ–‡ç« </h3>
					</div>
				</div>
			</div>
		</a>
	</div>
        <div class="lx-cover next lx-cover-sm" style="background-image: url(/images/footer_2.jpg)">
		<div class="overlay"></div>
		<a class="copy" href="/2019/12/09/Linux-grep-å‘½ä»¤/">
			<div class="display-t">
				<div class="display-tc">
					<div>
						<span>Prev</span>
						<h3>Linux grep å‘½ä»¤</h3>
					</div>
				</div>
			</div>
		</a>
	</div>
</div>
</div>

<footer>
  <div>
  Copyright &copy; 2019.<a href="/">Welcome to Fu Ming yao's personal blog</a><br>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> |  <img src="https://static.dy208.cn/o_1dfilp8ruo521thr1hvf18ji17soa.png">
  <a href="http://www.beian.miit.gov.cn/" style="color:#b93e28" target="_blank">äº¬ICPå¤‡19054690å·</a> 

  </div>
</footer>
</div>

<button class="menu-trigger"></button>
<div class="menu">
  <div class="menu-head">
    <span class="layer">
      <div class="col">
        <div class="row for-pic">
          <div class="profile-pic">
            <a href="/"><img src="/images/person_1.jpg" alt="ç¬¦é“­å°§"></a>
          </div>
        </div>
        <div class="row for-name">
          <p>ç¬¦é“­å°§</p>
          <span class="tagline">Hello, World!</span>
        </div>
      </div>
    </span>
  </div>
  <nav class="menu-container">
  <ul class="menu-items">
    <li><a href="/"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li>
    <li><a href="/archives/"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-bookmark fa-fw"></i>é¡µé¢</span>
        <ul>
          <li><a href="/guestbook">ç•™è¨€</a></li>
        <li><a href="/about">å…³äº</a></li>
        </ul>
    </li>
    <li class="has-sub"><span class="dropdown-heading">
      <i class="fa fa-link fa-fw"></i>å‹é“¾</span>
        <ul>
          <li> <a href="https://lx.blleng.cn" target="_blank">Theme-Lx</a></li>
        </ul>
    </li>
  </ul>
  </nav>
</div>

<div class="gototop js-top">
  <a href="#" class="js-gotop"><i class="fa fa-arrow-up"></i></a>
</div>
<script src="/js/jquery.easing.min.js"></script>
<script src="/js/jquery.waypoints.min.js"></script>
<script src="/js/jquery.stellar.min.js"></script>
<script src="/js/main.js"></script>


</body>
</html>
